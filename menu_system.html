<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø³ÛŒØ³ØªÙ… Ù…Ù†ÙˆÛŒ Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© Dima CMS</title>
    <style>
        body { font-family: Vazirmatn, Tahoma, sans-serif; background: #f9f9f9; color: #222; margin: 0; padding: 0; }
        .container { max-width: 900px; margin: 40px auto; background: #fff; border-radius: 12px; box-shadow: 0 2px 8px #0001; padding: 32px; }
        h1, h2, h3 { color: #007bff; }
        pre, code { background: #f3f3f3; border-radius: 6px; padding: 8px; direction: ltr; font-size: 0.95rem; }
        .tip { background: #e3fcec; border-right: 4px solid #28a745; padding: 8px 16px; border-radius: 6px; margin: 16px 0; }
        .back { margin-top: 32px; text-align: left; }
        .back a { color: #007bff; text-decoration: none; }
        table { border-collapse: collapse; width: 100%; margin: 16px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        th { background: #f0f8ff; }
    </style>
</head>
<body>
<div class="container">
    <h1>Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø³ÛŒØ³ØªÙ… Ù…Ù†ÙˆÛŒ Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© Dima CMS</h1>
    <div class="tip">
        Ø§ÛŒÙ† Ø³ÛŒØ³ØªÙ… Ø§Ù…Ú©Ø§Ù† Ø³Ø§Ø®Øª Ù…Ù†ÙˆÙ‡Ø§ÛŒ Ú†Ù†Ø¯Ø³Ø·Ø­ÛŒØŒ Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© Ùˆ Ù‚Ø§Ø¨Ù„ ØªÙˆØ³Ø¹Ù‡ Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ùˆ Ø³Ø§ÛŒØª ÙØ±Ø§Ù‡Ù… Ù…ÛŒâ€ŒÚ©Ù†Ø¯.
    </div>
    <h2>Û±. Ø³Ø§Ø®ØªØ§Ø± Ø¬Ø¯ÙˆÙ„ menus</h2>
    <pre><code>CREATE TABLE menus (
  id INT AUTO_INCREMENT PRIMARY KEY,
  title VARCHAR(100) NOT NULL,
  url VARCHAR(255) NOT NULL,
  icon VARCHAR(32) DEFAULT NULL,
  position VARCHAR(32) DEFAULT 'admin',
  parent_id INT DEFAULT NULL,
  sort_order INT DEFAULT 0,
  access_role VARCHAR(32) DEFAULT NULL,
  is_active TINYINT(1) DEFAULT 1,
  FOREIGN KEY (parent_id) REFERENCES menus(id) ON DELETE CASCADE
);</code></pre>
    <h2>Û². Ù…Ø¯Ù„ Menu Ùˆ Ù…ØªØ¯Ù‡Ø§</h2>
    <pre><code>class Menu extends Model {
    public function getByPosition($position = 'admin', $role = null) {...}
    public function getTree($position = 'admin', $role = null) {...}
}</code></pre>
    <h2>Û³. Ù†Ù…ÙˆÙ†Ù‡ Ø¯Ø±Ø¬ Ù…Ù†ÙˆÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡</h2>
    <pre><code>INSERT INTO menus (title, url, icon, position, parent_id, sort_order, access_role, is_active) VALUES
('Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯', '/admin/dashboard', 'ğŸ ', 'admin', NULL, 1, NULL, 1),
('Ú©Ø§Ø±Ø¨Ø±Ø§Ù†', '/admin/user', 'ğŸ‘¤', 'admin', NULL, 2, NULL, 1),
('Ù…Ø·Ø§Ù„Ø¨', '/admin/post', 'ğŸ“', 'admin', NULL, 3, NULL, 1),
('Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ', '/admin/category', 'ğŸ“‚', 'admin', NULL, 4, NULL, 1),
('ØµÙØ­Ø§Øª', '/admin/page', 'ğŸ“„', 'admin', NULL, 5, NULL, 1),
('ÙØ±ÙˆØ´Ú¯Ø§Ù‡', '/admin/shop', 'ğŸ›’', 'admin', NULL, 6, NULL, 1),
('ÙØ±Ù…â€ŒÙ‡Ø§', '/admin/form', 'ğŸ“‹', 'admin', NULL, 7, NULL, 1),
('ØªÙ†Ø¸ÛŒÙ…Ø§Øª', '/admin/settings', 'âš™ï¸', 'admin', NULL, 8, NULL, 1);
</code></pre>
    <h2>Û´. Ø±Ù†Ø¯Ø± Ù…Ù†ÙˆÛŒ Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© Ø¯Ø± layout</h2>
    <pre><code>require_once 'app/models/Menu.php';
$menuModel = new Menu();
$adminMenu = $menuModel->getTree('admin', $_SESSION['user']['role'] ?? null);
function renderMenu($items, $level = 0) {
    if (empty($items)) return;
    $ulClass = $level === 0 ? 'navbar-nav mx-auto' : 'dropdown-menu';
    echo '<ul class="' . $ulClass . '">';
    foreach ($items as $item) {
        $hasChildren = !empty($item['children']);
        $liClass = 'nav-item';
        if ($hasChildren) $liClass .= ' dropdown';
        echo '<li class="' . $liClass . '">';
        $aClass = $level === 0 ? 'nav-link' : 'dropdown-item';
        if ($hasChildren) $aClass .= ' dropdown-toggle';
        echo '<a class="' . $aClass . '" href="' . htmlspecialchars($item['url']) . '"' . ($hasChildren ? ' data-bs-toggle="dropdown"' : '') . '>' . ($item['icon'] ? $item['icon'] . ' ' : '') . htmlspecialchars($item['title']) . '</a>';
        if ($hasChildren) {
            renderMenu($item['children'], $level + 1);
        }
        echo '</li>';
    }
    echo '</ul>';
}
renderMenu($adminMenu);
</code></pre>
    <h2>Ûµ. Ù†Ú©Ø§Øª ØªÙˆØ³Ø¹Ù‡ Ùˆ Ø§Ù…Ù†ÛŒØª</h2>
    <ul>
        <li>Ù‡Ø± Ù…Ù†Ùˆ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¨ÛŒâ€ŒÙ†Ù‡Ø§ÛŒØª Ø²ÛŒØ±Ù…Ù†Ùˆ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯ (parent_id).</li>
        <li>Ø§Ù…Ú©Ø§Ù† ØªØ¹Ø±ÛŒÙ Ù…Ù†Ùˆ Ø¨Ø±Ø§ÛŒ Ù…ÙˆÙ‚Ø¹ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù (position: admin, header, footer Ùˆ ...).</li>
        <li>Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ø³Ø·Ø­ Ø¯Ø³ØªØ±Ø³ÛŒ (access_role) Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù…Ù†Ùˆ Ø¨Ù‡ Ù†Ù‚Ø´â€ŒÙ‡Ø§ÛŒ Ø®Ø§Øµ.</li>
        <li>Ø§ÙØ²ÙˆÙ†Ù‡â€ŒÙ‡Ø§ Ùˆ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ Ù…Ù†ÙˆÛŒ Ø¬Ø¯ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†Ù†Ø¯.</li>
        <li>Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² XSSØŒ ØªÙ…Ø§Ù… Ø®Ø±ÙˆØ¬ÛŒâ€ŒÙ‡Ø§ Ø¨Ø§ <code>htmlspecialchars</code> Ø±Ù†Ø¯Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯.</li>
        <li>Ø¨Ø±Ø§ÛŒ UX Ø¨Ù‡ØªØ±ØŒ Ø§Ø² CSS Ø³ÙØ§Ø±Ø´ÛŒ (menu.css) Ø¨Ø±Ø§ÛŒ dropdown Ú†Ù†Ø¯Ø³Ø·Ø­ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</li>
    </ul>
    <div class="tip">
        Ø¨Ø±Ø§ÛŒ Ø§ÙØ²ÙˆØ¯Ù† Ù…Ù†ÙˆÛŒ Ø¬Ø¯ÛŒØ¯ØŒ Ú©Ø§ÙÛŒ Ø§Ø³Øª Ø±Ú©ÙˆØ±Ø¯ Ø¬Ø¯ÛŒØ¯ Ø¨Ù‡ Ø¬Ø¯ÙˆÙ„ <b>menus</b> Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯ ÛŒØ§ Ø§Ø² Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª (Ø¯Ø± ØµÙˆØ±Øª ØªÙˆØ³Ø¹Ù‡) Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù†Ù…Ø§ÛŒÛŒØ¯.
    </div>
    <div class="back">
        <a href="../README.md">â¬… Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§ØµÙ„ÛŒ</a>
    </div>
</div>
</body>
</html> 